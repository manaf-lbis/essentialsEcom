<html lang="en">

<%- include('../../partials/htmlHeadUser.ejs',{csspath:'/css/userCss/profile/profile.css'})%>

    <body>
        <%- include('../../partials/userNavbar.ejs')%>

            <div class="profile-container">
                <div class="profile-layout">
                    <%- include('../../partials/userprofile/profileLayoutMinimal.ejs', { activePage: 'address' })%>

                        <main class="profile-content-card">
                            <div class="d-flex justify-content-between align-items-center mb-4 pb-2 border-bottom">
                                <h4 class="mb-0 fw-bold">Address Management</h4>
                                <button type="button" onclick="clearAllField()" class="btn btn-primary btn-sm"
                                    data-toggle="modal" data-target="#exampleModalCenter">
                                    <i class="fas fa-plus me-1"></i> Add New
                                </button>
                            </div>

                            <%if(addressDetails.length> 0) {%>
                                <div class="row g-3">
                                    <%for(let ele of addressDetails ){%>
                                        <div class="col-md-6 mb-3">
                                            <div class="card h-100 border p-3 bg-light rounded shadow-sm">
                                                <div class="d-flex justify-content-between align-items-start mb-2">
                                                    <span class="badge bg-secondary text-white">
                                                        <%= ele.defaultAddress ? 'Default' : 'Address'%>
                                                    </span>
                                                    <div class="dropdown">
                                                        <button class="btn btn-sm btn-link text-dark p-0" type="button"
                                                            id="dropdownMenuButton<%=ele._id%>" data-toggle="dropdown"
                                                            aria-haspopup="true" aria-expanded="false">
                                                            <i class="fas fa-ellipsis-v"></i>
                                                        </button>
                                                        <div class="dropdown-menu dropdown-menu-right"
                                                            aria-labelledby="dropdownMenuButton<%=ele._id%>">
                                                            <a class="dropdown-item editBtn" addressId="<%=ele._id%>"
                                                                href="#">Edit</a>
                                                            <a class="dropdown-item deleteBtn text-danger"
                                                                addressId="<%=ele._id%>" href="#">Delete</a>
                                                        </div>
                                                    </div>
                                                </div>
                                                <h6 class="fw-bold mb-1">
                                                    <%= ele.fullName%>
                                                </h6>
                                                <p class="mb-1 text-muted small">
                                                    <%= ele.houseName%>, <%= ele.street%>
                                                </p>
                                                <p class="mb-1 text-muted small">
                                                    <%= ele.area%>, <%= ele.city%>
                                                </p>
                                                <p class="mb-0 text-muted small">
                                                    <%= ele.state%> - <%= ele.pincode%>
                                                </p>
                                                <p class="mb-0 mt-2 text-primary small"><i
                                                        class="fas fa-phone-alt me-1"></i>
                                                    <%= ele.phone%>
                                                </p>
                                            </div>
                                        </div>
                                        <%}%>
                                </div>
                                <%} else {%>
                                    <div class="text-center py-5">
                                        <img src="/assets/images/no-address.svg" alt="No Address" class="mb-3"
                                            style="width: 100px; opacity: 0.5;">
                                        <p class="text-muted">No addresses saved yet.</p>
                                    </div>
                                    <%}%>

                                        <div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog"
                                            aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                                            <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
                                                <div class="modal-content">
                                                    <div class="modal-header bg-light">
                                                        <h5 class="modal-title" id="exampleModalLongTitle">Address
                                                            Details</h5>
                                                        <button type="button" class="close" data-dismiss="modal"
                                                            aria-label="Close">
                                                            <span aria-hidden="true">&times;</span>
                                                        </button>
                                                    </div>
                                                    <div class="modal-body p-4">
                                                        <form method="post" action="/addNewAddress"
                                                            id="addressAddingForm" role="form">
                                                            <input hidden name="addressId" id="hiddenId" type="text">

                                                            <div class="row mb-3">
                                                                <div class="col-md-6">
                                                                    <label for="fullName"
                                                                        class="form-label small text-muted">Full
                                                                        Name</label>
                                                                    <input type="text" id="fullName" name="fullName"
                                                                        class="form-control" placeholder="John Doe">
                                                                    <small class="text-danger" id="fullNameErr"></small>
                                                                </div>
                                                                <div class="col-md-6">
                                                                    <label for="phone"
                                                                        class="form-label small text-muted">Phone
                                                                        Number</label>
                                                                    <input type="text" name="phone" id="phone"
                                                                        class="form-control"
                                                                        placeholder="10-digit mobile number">
                                                                    <small class="text-danger" id="phoneErr"></small>
                                                                </div>
                                                            </div>

                                                            <div class="row mb-3">
                                                                <div class="col-md-6">
                                                                    <label for="houseName"
                                                                        class="form-label small text-muted">House
                                                                        Name/No.</label>
                                                                    <input type="text" id="houseName" name="houseName"
                                                                        class="form-control"
                                                                        placeholder="Apartment/House">
                                                                    <small class="text-danger"
                                                                        id="houseNameErr"></small>
                                                                </div>
                                                                <div class="col-md-6">
                                                                    <label for="street"
                                                                        class="form-label small text-muted">Street</label>
                                                                    <input type="text" id="street" name="street"
                                                                        class="form-control" placeholder="Street Name">
                                                                    <small class="text-danger" id="streetErr"></small>
                                                                </div>
                                                            </div>

                                                            <div class="row mb-3">
                                                                <div class="col-md-6">
                                                                    <label for="area"
                                                                        class="form-label small text-muted">Area/Locality</label>
                                                                    <input type="text" id="area" name="area"
                                                                        class="form-control" placeholder="Area">
                                                                    <small class="text-danger" id="areaErr"></small>
                                                                </div>
                                                                <div class="col-md-6">
                                                                    <label for="city"
                                                                        class="form-label small text-muted">City</label>
                                                                    <input type="text" id="city" name="city"
                                                                        class="form-control" placeholder="City">
                                                                    <small class="text-danger" id="cityErr"></small>
                                                                </div>
                                                            </div>

                                                            <div class="row mb-3">
                                                                <div class="col-md-4">
                                                                    <label for="state"
                                                                        class="form-label small text-muted">State</label>
                                                                    <select id="state" name="state"
                                                                        class="form-control">
                                                                        <option disabled selected value>Select State
                                                                        </option>
                                                                        <option value="Kerala">Kerala</option>
                                                                        <option value="Tamil Nadu">Tamil Nadu
                                                                        </option>
                                                                        <option value="Karnataka">Karnataka</option>
                                                                        <option value="Maharashtra">Maharashtra
                                                                        </option>

                                                                    </select>
                                                                    <small class="text-danger" id="stateErr"></small>
                                                                </div>
                                                                <div class="col-md-4">
                                                                    <label for="pincode"
                                                                        class="form-label small text-muted">Pincode</label>
                                                                    <input type="number" id="pincode" name="pincode"
                                                                        class="form-control" placeholder="6-digit code">
                                                                    <small class="text-danger" id="pincodeErr"></small>
                                                                </div>
                                                                <div class="col-md-4 d-flex align-items-center pt-4">
                                                                    <div class="custom-control custom-checkbox">
                                                                        <input type="checkbox"
                                                                            class="custom-control-input"
                                                                            id="defaultAddress" name="defaultAddress"
                                                                            value="true">
                                                                        <label class="custom-control-label"
                                                                            for="defaultAddress">Make
                                                                            Default</label>
                                                                    </div>
                                                                </div>
                                                            </div>

                                                            <div class="d-flex justify-content-end gap-2 mt-4">
                                                                <button type="button" class="btn btn-secondary"
                                                                    data-dismiss="modal">Cancel</button>
                                                                <button type="submit" id="newAddressSubmit"
                                                                    class="btn btn-primary">Save Address</button>
                                                            </div>
                                                        </form>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                        </main>
                </div>
            </div>

            <%- include('../../partials/userFooter.ejs')%>

                <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
                <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
                <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
                <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
                <script src="/js/userjs/profileSection/addressManagement.js"></script>
    </body>

</html>